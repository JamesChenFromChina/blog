title: ATT汇编语言学习笔记
date: 2017-10-16
tags: ATT Assembly
categories: Assembly
---

# 汇编语言复习
  转眼已经毕业8年了，刚毕业的时候学习的汇编知识发现已经遗忘了不少，确实在实际工作中用到的机会不是太多，但是偶尔还是可以帮助解决问题发现事情的本质，所以决定花些时间复习下，加之之前使用的书籍是 <Intel汇编语言程序设计>，主要使用的编译器是masm，由于目前主要在linux平台进行开发，所以还是希望进一步熟悉ATT语法，这次使用<汇编语言程序设计>来学习，这本书主要基于linux操作系统，使用ATT格式讲解，是一本公认好书。
  
  
## 官方参考手册
[官方手册](https://software.intel.com/sites/default/files/managed/39/c5/325462-sdm-vol-1-2abcd-3abcd.pdf)


  
## intel 指令格式
在intel手册的第二卷第二章给出了intel处理器指令的格式，包括现有的intel64和IA-32处理器都是使用的这种指令格式，了解指令的格式有助于我们理解汇编语言中的指令规律

Intel指令主要由四个部分组成
1. 可选的指令前缀
2. 操作码
3. 可选的修饰符 (ModR/M SIB 移位)
4. 可选的数据元素（立即数）

| 指令前缀 | 操作码  | ModR/M  | SIB     | 移位    | 数据元素 |
|:---------|:--------|:--------|:--------|:--------|:---------|
| 0-4字节  | 1-3字节 | 0-1字节 | 0-1字节 | 0-4字节 | 0-4字节  |

1. 操作码
    定义指令的基本功能，告诉CPU这条指令要完成什么任务

2. 指令前缀
    按照功能可以分成四组，每组一个字节，所以这个位置最多占4个字节，这四组分别是
    1. 锁定前缀和重复前缀
    2. 段覆盖前缀和分支提示前缀
    3. 操作数长度覆盖前缀
    4. 地址长度覆盖前缀
    
| 前缀名称           | 作用                                                                                                |
| :-------           | :---------                                                                                          |
| 锁定前缀           | 表示指令独占共享内存区 用于多核和超线程处理器                                                       |
| 重复前缀           | 表示重复的功能，多用于字符串处理等                                                                  |
| 段覆盖前缀         | 用于覆盖默认的段寄存器？ 第二章会讲                                                                 |
| 分支提示前缀       | 尝试提示处理器程序在跳转语句中最可能的路径 （likely unlikely）                                      |
| 操作数长度覆盖前缀 | 通知处理器程序将在16位和32位操作数之间切换,使程序在使用大操作数的时候能通知处理器，提高数据赋值速度 |
| 地址长度覆盖前缀   | 通知处理器程序将在16位和32位地址之间切换                                                            |
    
3. 修饰符
    修饰符用来定义执行的指令涉及的寄存器和内存位置，修饰符包含在三个单独的值中
    * 寻址方式说明符(ModR/M)字节
    * 比例-索引-基址(SIB)字节
    * 1\2\4个地址移位字节
